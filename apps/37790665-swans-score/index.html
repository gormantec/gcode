<!DOCTYPE html>
<html><head><link rel="manifest" href="/apps/37790665-swans-score/manifest.json"><meta name="mobile-web-app-capable" content="yes"><meta name="description" content="A gcode developed PWA app"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta property="fpwa:template" content="pwa=true,name=score,short_name=score,theme_color=#ed171f,background_color=#ed171f,display=standalone,orientation=any"><link rel="apple-touch-icon" href="/apps/37790665-swans-score/icon.png"><link rel="apple-touch-icon-precomposed" href="/apps/37790665-swans-score/icon.png"><link rel="icon" href="/apps/37790665-swans-score/icon.png"><style>
.splash{position:absolute;background-size:300px;background-image:url('splash.icon.png');background-position:center;background-repeat:no-repeat;top:0px;bottom:0px;left:0px;right:0px;color:#F0F0F0;background-color:#ed171f;}
.loader{font-size:50px;text-indent:-9999em;overflow:hidden;width:1em;height:1em;border-radius:50%;margin:72px auto;position:absolute;bottom:20px;left:20px;right:20px;bottom:0;-webkit-transform:translateZ(0);-ms-transform:translateZ(0);transform:translateZ(0);-webkit-animation:load6 1.7s infinite ease,round 1.7s infinite ease;animation:load6 1.7s infinite ease,round 1.7s infinite ease}@-webkit-keyframes load6{0%{box-shadow:0 -.83em 0 -.4em,0 -.83em 0 -.42em,0 -.83em 0 -.44em,0 -.83em 0 -.46em,0 -.83em 0 -.477em}5%,95%{box-shadow:0 -.83em 0 -.4em,0 -.83em 0 -.42em,0 -.83em 0 -.44em,0 -.83em 0 -.46em,0 -.83em 0 -.477em}10%,59%{box-shadow:0 -.83em 0 -.4em,-.087em -.825em 0 -.42em,-.173em -.812em 0 -.44em,-.256em -.789em 0 -.46em,-.297em -.775em 0 -.477em}20%{box-shadow:0 -.83em 0 -.4em,-.338em -.758em 0 -.42em,-.555em -.617em 0 -.44em,-.671em -.488em 0 -.46em,-.749em -.34em 0 -.477em}38%{box-shadow:0 -.83em 0 -.4em,-.377em -.74em 0 -.42em,-.645em -.522em 0 -.44em,-.775em -.297em 0 -.46em,-.82em -.09em 0 -.477em}100%{box-shadow:0 -.83em 0 -.4em,0 -.83em 0 -.42em,0 -.83em 0 -.44em,0 -.83em 0 -.46em,0 -.83em 0 -.477em}}@keyframes load6{0%{box-shadow:0 -.83em 0 -.4em,0 -.83em 0 -.42em,0 -.83em 0 -.44em,0 -.83em 0 -.46em,0 -.83em 0 -.477em}5%,95%{box-shadow:0 -.83em 0 -.4em,0 -.83em 0 -.42em,0 -.83em 0 -.44em,0 -.83em 0 -.46em,0 -.83em 0 -.477em}10%,59%{box-shadow:0 -.83em 0 -.4em,-.087em -.825em 0 -.42em,-.173em -.812em 0 -.44em,-.256em -.789em 0 -.46em,-.297em -.775em 0 -.477em}20%{box-shadow:0 -.83em 0 -.4em,-.338em -.758em 0 -.42em,-.555em -.617em 0 -.44em,-.671em -.488em 0 -.46em,-.749em -.34em 0 -.477em}38%{box-shadow:0 -.83em 0 -.4em,-.377em -.74em 0 -.42em,-.645em -.522em 0 -.44em,-.775em -.297em 0 -.46em,-.82em -.09em 0 -.477em}100%{box-shadow:0 -.83em 0 -.4em,0 -.83em 0 -.42em,0 -.83em 0 -.44em,0 -.83em 0 -.46em,0 -.83em 0 -.477em}}@-webkit-keyframes round{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes round{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}
</style><script>
  window.PWA={globals:{}};
  window.PWA.globals.appName="score";
  window.PWA.globals.orientation="any";
  window.PWA.globals.icon="icon.png";
  window.PWA.globals.icon180x180="180x180.icon.png";
  window.PWA.globals.icon192x192="192x192.icon.png";
  window.PWA.globals.icon512x512="512x512.icon.png";
  window.PWA.globals.splash="splash.png";
  window.PWA.globals.splashColor="#F0F0F0";
  window.PWA.globals.mockFrame="iphoneX";
  window.PWA.globals.splashBackgroundColor="#ed171f";
  window.PWA.globals.splashDuration=2000;

let deferredPrompt;
if('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/apps/37790665-swans-score/sw.js');
};

function addToHomeScreen() {
   let a2hsBtn = document.querySelector(".ad2hs-prompt");
   a2hsBtn.style.display = 'none'; 
   deferredPrompt.prompt();
   deferredPrompt.userChoice.then(function(choiceResult){
   if (choiceResult.outcome === 'accepted') console.log('User accepted the A2HS prompt');
   else console.log('User dismissed the A2HS prompt');
   deferredPrompt = null;
 });}
function showAddToHomeScreen() {
   let a2hsBtn = document.querySelector(".ad2hs-prompt");
   a2hsBtn.style.display ="block";
   a2hsBtn.addEventListener("click", addToHomeScreen);
 }
 window.addEventListener('beforeinstallprompt', function (e) {
   e.preventDefault();
   deferredPrompt = e;
   showAddToHomeScreen();
   setTimeout(()=>{document.querySelector(".ad2hs-prompt").style.display ="none";},10000);
 });
function showIosInstall() {
  let iosPrompt = document.querySelector(".ios-prompt");
  if(iosPrompt)iosPrompt.style.display = "block";
  if(iosPrompt)iosPrompt.addEventListener("click", () => {
  if(iosPrompt)iosPrompt.style.display = "none";
  });
}

const isIos = () => {
  const userAgent = window.navigator.userAgent.toLowerCase();
  return /iphone|ipad|ipod/.test( userAgent );
}
const isInStandaloneMode = () => ('standalone' in window.navigator) && (window.navigator.standalone);
document.addEventListener("DOMContentLoaded", ()=>{
   console.log("DOMContentLoaded");
   if (isIos() && !isInStandaloneMode()) {
  showIosInstall();
   console.log("showIosInstall");
  }
});

</script><script type="module">
import { addkey } from "https://gcode.com.au/modules/near/index.mjs";

if (window.opener && window.opener !== window) {
    window.addEventListener("message",function(e){if(e.origin=="https://gcode.com.au")addkey(e.data);},false);
    window.addEventListener("load", (event) => {window.opener.postMessage("loaded","https://gcode.com.au");});
}

</script><script type="module">
/*

  filename:git://gormantec:gcode_repo/swans-score.mjs
  created: 2022-8-6T09:59:52
  appName: swans-score
  splashSize: 300px
  splash: git://gormantec:gcode_repo/swans-score.svg
  mockFrame: iphoneX
  splashBackgroundColor: #ed171f
  splashDuration: 2000

*/

/*---------------------------------------------------------------------------*/
import {
    PWA,
    Page,
    Div
} from 'https://gcode.com.au/modules/pwa.mjs';
try {
    Page.clearPages();
} catch (e) {}
/*---------------------------------------------------------------------------*/
let DATELable = new Div({
    "top": "20px",
    "left": "60px",
    "innerText": "Bounce:"
});
let DATE = new Div({
    "top": "20px",
    "left": "130px",
    "innerText": "TEST"
});
let HTEAM = new Div({
    "top": "60px",
    "fontSize": "26px",
    "left": "30px",
    "innerText": "Home",
    "width": "160px",
    "height": "30px",
    "color": "white",
    "backgroundColor": "#002b5c",
    "textAlign": "center"
});
let ATEAM = new Div({
    "top": "60px",
    "fontSize": "26px",
    "left": "190px",
    "innerText": "Away",
    "width": "160px",
    "height": "30px",
    "color": "white",
    "backgroundColor": "#ed171f",
    "textAlign": "center"
});
let HG = new Div({
    "top": "90px",
    "fontSize": "26px",
    "left": "30px",
    "innerText": "0",
    "width": "160px",
    "height": "30px",
    "color": "white",
    "backgroundColor": "#002b5c",
    "textAlign": "center"
});
let HP = new Div({
    "top": "120px",
    "fontSize": "26px",
    "left": "30px",
    "innerText": "0",
    "width": "160px",
    "height": "30px",
    "color": "white",
    "backgroundColor": "#002b5c",
    "textAlign": "center"
});
let HS = new Div({
    "top": "150px",
    "fontSize": "26px",
    "left": "30px",
    "innerText": "0",
    "width": "160px",
    "height": "30px",
    "color": "white",
    "backgroundColor": "#002b5c",
    "textAlign": "center"
});
let AG = new Div({
    "top": "90px",
    "fontSize": "26px",
    "left": "190px",
    "innerText": "0",
    "width": "160px",
    "height": "30px",
    "color": "white",
    "backgroundColor": "#ed171f",
    "textAlign": "center"
});
let AP = new Div({
    "top": "120px",
    "fontSize": "26px",
    "left": "190px",
    "innerText": "0",
    "width": "160px",
    "height": "30px",
    "color": "white",
    "backgroundColor": "#ed171f",
    "textAlign": "center"
});
let AS = new Div({
    "top": "150px",
    "fontSize": "26px",
    "left": "190px",
    "innerText": "0",
    "width": "160px",
    "height": "30px",
    "color": "white",
    "backgroundColor": "#ed171f",
    "textAlign": "center"
});
let LOGO = new Div({
    "marginTop": "200px",
    "backgroundColor": "white",
    "backgroundPosition": "center",
    "backgroundSize": "60%",
    "backgroundRepeat": "no-repeat",
    "backgroundImage": "url(https://sportsfancovers.com/wp-content/uploads/2020/04/Sydney_Swans_Logo-249x300.png)",
});

let counter = new Div({
    "bottom": "20px",
    "backgroundColor": "white",
    "fontSize": "32px",
    "left": "100px",
    "innerText": "0:00",
    "width": "180px",
    "height": "36px",
    "color": "black",
    "textAlign": "center"
});

class HomePage extends Page {

    constructor() {
        super({
            "color": "black",
            "backgroundColor": "white",
            "children": [LOGO, DATELable, DATE, ATEAM, HTEAM, HG, HP, HS, AG, AP, AS, counter]
        });

        setInterval(() => {
            fetch("https://api.squiggle.com.au/?q=games;team=16;round=22;year=2022")
                .then((response) => response.json())
                .then((data) => {
                    console.log(data);
                    if (data.games[0].date) {
                        let b = Date.parse(data.games[0].date.replaceAll(" ", "T"));
                        console.log(b);
                        let n = Date.now();
                        if (b > n) {
                            let allsec = Math.floor((b - n) / 1000);
                            let sec = allsec - Math.floor(allsec / 60) * 60;
                            let allmin = Math.floor(allsec / 60);
                            let min = allmin - Math.floor(allmin / 60) * 60;
                            let hours = Math.floor(allmin / 60);

                            counter.element.innerHTML = hours + ":" + ("00" + min).slice(-2) + ":" + ("00" + sec).slice(-2);
                        } else if(data.games[0].complete==100) {
   
                            counter.element.innerHTML = "COMPLETE";
                        }
                        else if(data.games[0].complete<25){
                            let allsec=Math.floor(60*20*(25-data.games[0].complete)/25);
                            let sec = allsec - Math.floor(allsec / 60) * 60;
                            let allmin = Math.floor(allsec / 60);
                            let min = allmin - Math.floor(allmin / 60) * 60;
                            counter.element.innerHTML = "Q1 "+("00" + min).slice(-2) + ":" + ("00" + sec).slice(-2);
                        }
                        else if(data.games[0].complete<50){
                            let allsec=Math.floor(60*20*(25-(data.games[0].complete-25))/25);
                            let sec = allsec - Math.floor(allsec / 60) * 60;
                            let allmin = Math.floor(allsec / 60);
                            let min = allmin - Math.floor(allmin / 60) * 60;
                            counter.element.innerHTML = "Q2 "+("00" + min).slice(-2) + ":" + ("00" + sec).slice(-2);
                        }
                        else if(data.games[0].complete<75){
                            let allsec=Math.floor(60*20*(25-(data.games[0].complete-50))/25);
                            let sec = allsec - Math.floor(allsec / 60) * 60;
                            let allmin = Math.floor(allsec / 60);
                            let min = allmin - Math.floor(allmin / 60) * 60;
                            counter.element.innerHTML = "Q3 "+("00" + min).slice(-2) + ":" + ("00" + sec).slice(-2);
                        }
                        else if(data.games[0].complete<100){
                            let allsec=Math.floor(60*20*(25-(data.games[0].complete-75))/25);
                            let sec = allsec - Math.floor(allsec / 60) * 60;
                            let allmin = Math.floor(allsec / 60);
                            let min = allmin - Math.floor(allmin / 60) * 60;
                            counter.element.innerHTML = "Q4 "+("00" + min).slice(-2) + ":" + ("00" + sec).slice(-2);
                        }
                    }
                    DATE.element.innerHTML = data.games[0].date;
                    ATEAM.element.innerHTML = data.games[0].ateam;
                    HTEAM.element.innerHTML = data.games[0].hteam;
                    HG.element.innerHTML = data.games[0].hgoals || 0;
                    HP.element.innerHTML = data.games[0].hbehinds || 0;
                    HS.element.innerHTML = data.games[0].hscore || 0;
                    AG.element.innerHTML = data.games[0].agoals || 0;
                    AP.element.innerHTML = data.games[0].abehinds || 0;
                    AS.element.innerHTML = data.games[0].ascore || 0;
                });
        }, 5000);
    }

}

/*---------------------------------------------------------------------------*/
var myDiv = new Div({
    innerHTML: "url(https://gcode.com.au/html/test.html)"
});
var aHomePage = new HomePage();
var aPWA = new PWA({
    title: "Sydney Swans Score Card",
    footer: "https://www.gormantec.com",
    primaryColor: "#ed171f",
});

aPWA.setPage(aHomePage);
aPWA.show();
/*---------------------------------------------------------------------------*/
</script></head><body><div class="splash"></div><div class="loader">Loading...</div></body></html>