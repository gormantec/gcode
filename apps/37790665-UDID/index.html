<!DOCTYPE html>
<html><head><link rel="manifest" href="/apps/37790665-UDID/manifest.json"><meta name="mobile-web-app-capable" content="yes"><meta name="description" content="An app to retrive the UDID from your iPhone. It will require you download and install a profile, allowing access to your UDID. You can delete the profile after that."><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta property="fpwa:template" content="pwa=true,name=UDID,short_name=UDID,theme_color=#323232,background_color=#323232,display=standalone,orientation=any"><link rel="apple-touch-icon" href="/apps/37790665-UDID/icon.png"><link rel="apple-touch-icon-precomposed" href="/apps/37790665-UDID/icon.png"><link rel="icon" href="/apps/37790665-UDID/icon.png"><style>
.splash{position:absolute;background-size:100px;background-image:url('splash.icon.png');background-position:center;background-repeat:no-repeat;top:0px;bottom:0px;left:0px;right:0px;color:#F0F0F0;background-color:#323232;}
.loader{font-size:50px;text-indent:-9999em;overflow:hidden;width:1em;height:1em;border-radius:50%;margin:72px auto;position:absolute;bottom:20px;left:20px;right:20px;bottom:0;-webkit-transform:translateZ(0);-ms-transform:translateZ(0);transform:translateZ(0);-webkit-animation:load6 1.7s infinite ease,round 1.7s infinite ease;animation:load6 1.7s infinite ease,round 1.7s infinite ease}@-webkit-keyframes load6{0%{box-shadow:0 -.83em 0 -.4em,0 -.83em 0 -.42em,0 -.83em 0 -.44em,0 -.83em 0 -.46em,0 -.83em 0 -.477em}5%,95%{box-shadow:0 -.83em 0 -.4em,0 -.83em 0 -.42em,0 -.83em 0 -.44em,0 -.83em 0 -.46em,0 -.83em 0 -.477em}10%,59%{box-shadow:0 -.83em 0 -.4em,-.087em -.825em 0 -.42em,-.173em -.812em 0 -.44em,-.256em -.789em 0 -.46em,-.297em -.775em 0 -.477em}20%{box-shadow:0 -.83em 0 -.4em,-.338em -.758em 0 -.42em,-.555em -.617em 0 -.44em,-.671em -.488em 0 -.46em,-.749em -.34em 0 -.477em}38%{box-shadow:0 -.83em 0 -.4em,-.377em -.74em 0 -.42em,-.645em -.522em 0 -.44em,-.775em -.297em 0 -.46em,-.82em -.09em 0 -.477em}100%{box-shadow:0 -.83em 0 -.4em,0 -.83em 0 -.42em,0 -.83em 0 -.44em,0 -.83em 0 -.46em,0 -.83em 0 -.477em}}@keyframes load6{0%{box-shadow:0 -.83em 0 -.4em,0 -.83em 0 -.42em,0 -.83em 0 -.44em,0 -.83em 0 -.46em,0 -.83em 0 -.477em}5%,95%{box-shadow:0 -.83em 0 -.4em,0 -.83em 0 -.42em,0 -.83em 0 -.44em,0 -.83em 0 -.46em,0 -.83em 0 -.477em}10%,59%{box-shadow:0 -.83em 0 -.4em,-.087em -.825em 0 -.42em,-.173em -.812em 0 -.44em,-.256em -.789em 0 -.46em,-.297em -.775em 0 -.477em}20%{box-shadow:0 -.83em 0 -.4em,-.338em -.758em 0 -.42em,-.555em -.617em 0 -.44em,-.671em -.488em 0 -.46em,-.749em -.34em 0 -.477em}38%{box-shadow:0 -.83em 0 -.4em,-.377em -.74em 0 -.42em,-.645em -.522em 0 -.44em,-.775em -.297em 0 -.46em,-.82em -.09em 0 -.477em}100%{box-shadow:0 -.83em 0 -.4em,0 -.83em 0 -.42em,0 -.83em 0 -.44em,0 -.83em 0 -.46em,0 -.83em 0 -.477em}}@-webkit-keyframes round{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes round{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}
</style><script>
  window.PWA={globals:{}};
  window.PWA.globals.appName="UDID";
  window.PWA.globals.orientation="any";
  window.PWA.globals.icon="icon.png";
  window.PWA.globals.icon180x180="180x180.icon.png";
  window.PWA.globals.icon192x192="192x192.icon.png";
  window.PWA.globals.icon512x512="512x512.icon.png";
  window.PWA.globals.splash="splash.png";
  window.PWA.globals.splashColor="#F0F0F0";
  window.PWA.globals.mockFrame="iphoneX";
  window.PWA.globals.splashBackgroundColor="#323232";
  window.PWA.globals.splashDuration=2000;

let deferredPrompt;
if('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/apps/37790665-UDID/sw.js');
};

function addToHomeScreen() {
   let a2hsBtn = document.querySelector(".ad2hs-prompt");
   a2hsBtn.style.display = 'none'; 
   deferredPrompt.prompt();
   deferredPrompt.userChoice.then(function(choiceResult){
   if (choiceResult.outcome === 'accepted') console.log('User accepted the A2HS prompt');
   else console.log('User dismissed the A2HS prompt');
   deferredPrompt = null;
 });}
function showAddToHomeScreen() {
   let a2hsBtn = document.querySelector(".ad2hs-prompt");
   a2hsBtn.style.display ="block";
   a2hsBtn.addEventListener("click", addToHomeScreen);
 }
 window.addEventListener('beforeinstallprompt', function (e) {
   e.preventDefault();
   deferredPrompt = e;
   showAddToHomeScreen();
   setTimeout(()=>{document.querySelector(".ad2hs-prompt").style.display ="none";},10000);
 });
function showIosInstall() {
  let iosPrompt = document.querySelector(".ios-prompt");
  if(iosPrompt)iosPrompt.style.display = "block";
  if(iosPrompt)iosPrompt.addEventListener("click", () => {
  if(iosPrompt)iosPrompt.style.display = "none";
  });
}

const isIos = () => {
  const userAgent = window.navigator.userAgent.toLowerCase();
  return /iphone|ipad|ipod/.test( userAgent );
}
const isInStandaloneMode = () => ('standalone' in window.navigator) && (window.navigator.standalone);
document.addEventListener("DOMContentLoaded", ()=>{
   console.log("DOMContentLoaded");
   if (isIos() && !isInStandaloneMode()) {
  showIosInstall();
   console.log("showIosInstall");
  }
});

</script><script type="module">
import { addkey } from "https://gcode.com.au/modules/near/index.mjs";

if (window.opener && window.opener !== window) {
    window.addEventListener("message",function(e){if(e.origin=="https://gcode.com.au")addkey(e.data);},false);
    window.addEventListener("load", (event) => {window.opener.postMessage("loaded","https://gcode.com.au");});
}

</script><script type="module">
/*

  filename:git://gormantec:gcode_repo/udid.mjs
  created: 2022-6-6T18:50:17
  appName: UDID
  splashSize: 100px
  splash: git://gormantec:gcode_repo/udid.svg
  mockFrame: iphoneX
  splashBackgroundColor: #323232
  splashDuration: 2000
  description: An app to retrive the UDID from your iPhone. It will require you download and install a profile, allowing access to your UDID. You can delete the profile after that.
  permittedUrls: ["https://isjqwevc8e.execute-api.ap-southeast-2.amazonaws.com/default/udid"]

    
  
*/
/*---------------------------------------------------------------------------*/
import {
    PWA,
    Page,
    Div,
    AuthButtons
} from 'https://gcode.com.au/modules/pwa.mjs';

/*
import {
    AppleAuthButton
} from './lib/apple-auth.lib.mjs';
*/


//console.log("AppleID=" + AppleID);
//console.log(AppleID);


try {
    Page.clearPages();
} catch (e) {}
/*---------------------------------------------------------------------------*/
class HomePage extends Page {
    constructor() {
        super({
            "color": "#dddddd",
            "backgroundColor": "#000000",
            "hideFloatingActionButton": "true",
            "children": [new Div({
                    "marginTop": "40px",
                    "display": "flex",
                    "justifyContent": "left",
                    "classNameOverride": "true",
                    "child": new Div({
                        "classNameOverride": "true",
                        "children": [
                            new Div({
                              	"marginLeft":"30px",
                                "position": "relative",
                                "display": "inline-block",
                                "innerText": "UDID:",
                              	"width":"50px"
                            }),
                            new Div({
                                "marginLeft": "5px",
                              	"padding":"4px",
                              	"width":"240px",
                                "position": "relative",
                                "display": "inline-block",
                                "innerText": "0000",
                              	"backgroundColor":"#323232"
                            })
                        ]
                    })

                }),
                new Div({
                    "marginTop": "10px",
                    "display": "flex",
                    "justifyContent": "left",
                    "classNameOverride": "true",
                    "child": new Div({
                        "classNameOverride": "true",
                        "children": [
                            new Div({
                              	"marginLeft":"30px",
                                "position": "relative",
                                "display": "inline-block",
                                "innerText": "Email:",
                              	"width":"50px"
                            }),
                            new Div({
                                "marginLeft": "5px",
                              	"padding":"4px",
                              	"width":"240px",
                                "position": "relative",
                                "display": "inline-block",
                                "innerText": "your-email@email.com",
                              	"backgroundColor":"#323232"
                            })
                        ]
                    })

                }),

                new Div({
                    "classNameOverride": "true",
                    "display": "block",
                    "marginLeft": "40px",
                    "fontSize": "11px",
                    "marginTop": "30px",
                    "innerHTML": "1) Download the profile with \"Get UDID\" below.<br><br>2) Go to Settings -> General -> Profile --or-- <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Settings -> General ->VPN & Device Management.<br><br>3) Then Install profile: \"Gorman Technology Pty Ltd\"<br><br>4) Login to your Apple ID below to get email.<br><br>5) This will email your ID and UDID to gormantec.<br><br><br>* The profile is unsigned, you can ignore the warning."
                })
            ]
        });
        this.appendChild(new Div({
            "display": "flex",
            "justifyContent": "center",
            child: new Div({
                "id": "getUDIDButton",
                "position": "absolute",
                "bottom": "35px",
                "height": "35px",
                "width": "200px",
                borderRadius: "8px",
                paddingTop: "14px",
                backgroundColor: "#555555",
                fontSize: "20px",
                "cursor": "pointer",
                "pointerEvents": "auto",
                "zIndex": "10001",
                "textAlign": "center",
                "innerText": "Get UDID",
                "display": "none",
                onclick: () => {
                    document.getElementById("getUDIDButton").style.display = "none";
                    window.location.href = "https://isjqwevc8e.execute-api.ap-southeast-2.amazonaws.com/default/udid";

                }
            })
        }));
        this.appendChild(new Div({
            "display": "flex",
            "justifyContent": "center",
            child: new Div({
                "id": "sendToGcodeButton",
                "position": "absolute",
                "bottom": "35px",
                "height": "35px",
                "width": "200px",
                borderRadius: "8px",
                paddingTop: "14px",
                backgroundColor: "#555555",
                fontSize: "20px",
                "cursor": "pointer",
                "pointerEvents": "auto",
                "zIndex": "10001",
                "textAlign": "center",
                "innerText": "Send info to gcode",
                "display": "none",
                onclick: () => {
                    console.log("click");
                    fetch("https://isjqwevc8e.execute-api.ap-southeast-2.amazonaws.com/default/udid?UDID=" + encodeURIComponent(localStorage.getItem('UDID')) + "&Email=" + encodeURIComponent(localStorage.getItem('Email')))
                        .then(response => response.json())
                        .then(data => console.log(data));
                    document.getElementById("sendToGcodeButton").style.display = "none";
                }
            })
        }));
        const _this = this;  
        this.appendChild(new AuthButtons({            

            "id": "getEmailButton",
            applekey: "au.com.gcode.appleauth",
            appearance: "list",
            bottom: "20px",
            onsignin: (s) => {
                if (s.email) localStorage.setItem('Email', s.email);
                if (s.name) localStorage.setItem('Name', s.name);
                _this.setEmail(s.email);
                document.getElementById("sendToGcodeButton").style.display = "block";
                document.getElementById("getUDIDButton").style.display = "none";
                document.getElementById("getEmailButton").style.display = "none";

            }
        }));



    }

    setUUID(aUDID) {
        this.firstChild.firstChild.children[1].innerText = aUDID;
    }
    setEmail(email) {
        console.log(this.firstChild.children);
        this.element.children[1].firstChild.children[1].innerText = email;
    }

}




/*---------------------------------------------------------------------------*/
var myDiv = new Div({
    innerHTML: "url(https://gcode.com.au/html/test.html)"
});
var aHomePage = new HomePage();
var aPWA = new PWA({
    "title": "Gorman Technology Pty Ltd",
    "footer": "https://www.gormantec.com",
    "primaryColor": "#323232",
    "pwaAuth": "true",
    "promptToInstall": "false"       
});
aPWA.setPage(aHomePage);
aPWA.floatingActionButton.onclick(function() {
    window.location.href = "https://isjqwevc8e.execute-api.ap-southeast-2.amazonaws.com/default/udid";
});

const queryString = window.location.search;
const urlParams = new URLSearchParams(queryString);
let aUDID_Param = urlParams.get('UDID');
aHomePage.setUUID("00000000-0000000000000000");
if (aUDID_Param) {
    aHomePage.setUUID(aUDID_Param);
    localStorage.setItem('UDID', aUDID_Param);
    window.location.replace("https://gcode.com.au/apps/37790665-UDID/index.html");
} else {
    window.addEventListener('pwaLoaded', function() {
        let aUDID = localStorage.getItem('UDID');
        let aEmail = localStorage.getItem('Email');
        if (aUDID && aEmail && aUDID.trim().length > 0 && aEmail.trim().length > 0) {
            console.log("Email and UDID exist");
            aHomePage.setUUID(aUDID);
            aHomePage.setEmail(aEmail);
            aHomePage.children[3].firstChild.style.display = "none"; //getUDIDButton
            aHomePage.children[5].firstChild.style.display = "none"; //getEmailButton
            aHomePage.children[4].firstChild.style.display = "block"; //sendToGcodeButton
            // document.getElementById("getUDIDButton").style.display = "none";
            //document.getElementById("getEmailButton").style.display = "none";
            //document.getElementById("sendToGcodeButton").style.display = "block";
        } else if (aUDID && aUDID.trim().length > 0) {

            console.log("Only UDID exist");
            aHomePage.setUUID(aUDID);
            aHomePage.children[3].firstChild.style.display = "none"; //getUDIDButton
            aHomePage.children[5].firstChild.style.display = "block"; //getEmailButton
            aHomePage.children[4].firstChild.style.display = "none"; //sendToGcodeButton
            //document.getElementById("getUDIDButton").style.display = "none";
            //document.getElementById("getEmailButton").style.display = "block";
            //document.getElementById("sendToGcodeButton").style.display = "none";
        } else if (aEmail && aEmail.trim().length > 0) {
            console.log("Only aEmail exist");
            aHomePage.setEmail(aEmail);
            aHomePage.children[3].firstChild.style.display = "block"; //getUDIDButton
            aHomePage.children[5].firstChild.style.display = "none"; //getEmailButton
            aHomePage.children[4].firstChild.style.display = "none"; //sendToGcodeButton
            //document.getElementById("getUDIDButton").style.display = "block";
            //document.getElementById("getEmailButton").style.display = "none";
            //document.getElementById("sendToGcodeButton").style.display = "none";
        } else {
            console.log("Neither UDID or aEmail exist");
            aHomePage.children[3].firstChild.style.display = "block"; //getUDIDButton
            aHomePage.children[5].firstChild.style.display = "none"; //getEmailButton
            aHomePage.children[4].firstChild.style.display = "none"; //sendToGcodeButton
            //document.getElementById("getUDIDButton").style.display = "none";
            //document.getElementById("getEmailButton").style.display = "block";
            //document.getElementById("sendToGcodeButton").style.display = "none";
        }
    });
}


function getCookie(cname) {
    let name = cname + "=";
    let decodedCookie = decodeURIComponent(document.cookie);
    let ca = decodedCookie.split(';');
    for (let i = 0; i < ca.length; i++) {
        let c = ca[i];
        while (c.charAt(0) == ' ') {
            c = c.substring(1);
        }
        if (c.indexOf(name) == 0) {
            return c.substring(name.length, c.length);
        }
    }
    return "";
}

let appPlatform = getCookie("app-platform");
if (appPlatform) aHomePage.setUUID(appPlatform);


aPWA.show();
/*---------------------------------------------------------------------------*/
</script></head><body><div class="splash"></div><div class="loader">Loading...</div></body></html>